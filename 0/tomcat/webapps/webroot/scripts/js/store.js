function getWindowSize(){$(".debuginfo").text("width:"+document.body.clientWidth+",height"+document.body.clientHeight)}!function(){var BI=window.parent.BI||{},Dec=window.parent.Dec||{};window.PluginHelper||(window.PluginHelper={}),PluginHelper.installPluginOnline=PluginHelper.installPluginOnline||function(pluginInfo,callback){if(PluginHelper.isWar)PluginUtils.showNeededDialog(Store.parseI18n("Fine-Plugin_Shop_Error_No_Support_In_War_Or_Cluster"));else{PluginHelper.getProgress("install",function(value){if(value&&value.progress&&callback(value.progress),value&&value.status){callback.call(this,value.status);var switchedReason,info=value.info||"";if("success"===value.status)value.extraAttribute&&(switchedReason=value.extraAttribute.switchedReason),PluginUtils.showNeededDialog(info+Store.parseI18n("Fine-Plugin_Shop_Install_Success")+(switchedReason?"<br>"+switchedReason:""),!0);else"failed"===value.status&&("37"===value.errorCode?PluginUtils.showConfirmDialog(Store.parseI18n("Fine-Plugin_Shop_Has_Install_Lower"),function(){Store.Progress.showProgress();var arry=pluginInfo.split("_"),pluginInfoArray=[Store.Installed.findInstalledPluginByID(arry[0])];PluginHelper.updatePluginOnline(pluginInfoArray,callback)}):PluginUtils.showNeededDialog(info))}}),PluginUtils.installPluginOnline({pluginInfo:pluginInfo,username:Dec.personal.username},function(res){})}},PluginHelper.useSocketIo=PluginHelper.useSocketIo||function(cmd,callback){if(window.parent.io){var listener="plugin_status_"+cmd;Dec.socket.hasListeners(listener)&&Dec.socket.removeListener(listener),Dec.socket.on(listener,function(a){callback.call(this,a)})}},PluginHelper.getProgress=PluginHelper.getProgress||function(cmd,callback){PluginHelper.useSocketIo(cmd,callback)},PluginHelper.installPluginFromDisk=PluginHelper.installPluginFromDisk||function(path,callback){var self=this;if(PluginHelper.isWar)PluginUtils.showNeededDialog(Store.parseI18n("Fine-Plugin_Shop_Error_No_Support_In_War_Or_Cluster"));else{PluginHelper.getProgress("install_from_disk",function(value){if(value&&value.progress&&callback(value.progress),value&&value.status){callback.call(this,value.status);var switchedReason,info=value.info||"";if("success"===value.status)value.extraAttribute&&(switchedReason=value.extraAttribute.switchedReason),PluginUtils.showNeededDialog(info+Store.parseI18n("Fine-Plugin_Shop_Install_Success")+(switchedReason?"<br>"+switchedReason:""),!0);else"failed"===value.status&&("37"===value.errorCode?PluginUtils.showConfirmDialog(Store.parseI18n("Fine-Plugin_Shop_Has_Install_Lower"),function(){Store.Progress.showProgress();var licenses=self.installFromDiskEditor.getValue(),attachId=licenses[licenses.length-1].attach_id;PluginHelper.updatePluginFromDisk({id:attachId,username:Dec.personal.username},callback)}):PluginUtils.showNeededDialog(info))}}),path&&path.id?PluginUtils.installPluginFromDisk(path,function(res){}):$("#install-from-disk input").click()}},PluginHelper.createMuiltFile=PluginHelper.createMuiltFile||function(renderEl,callback){return BI.createWidget({element:renderEl,type:"bi.multifile_editor",url:Dec.fineServletURL+"/v10/attach/upload?width=32&height=32&"+window.parent.DecCst.Cookie.URL_TOKEN+"="+BI.Cache.getCookie(window.parent.DecCst.Cookie.TOKEN),width:0,height:0,listeners:[{eventName:BI.MultifileEditor.EVENT_CHANGE,action:function(v){this.upload()}},{eventName:BI.MultifileEditor.EVENT_UPLOADED,action:function(){var licenses=this.getValue(),attachId=licenses[licenses.length-1].attach_id;callback.call(this,{id:attachId,username:Dec.personal.username})}}]})},PluginHelper.uninstallPlugin=PluginHelper.uninstallPlugin||function(pluginMarker,isForce,callback){PluginHelper.isWar?PluginUtils.showNeededDialog(Store.parseI18n("Fine-Plugin_Shop_Error_No_Support_In_War_Or_Cluster")):PluginUtils.showConfirmDialog(Store.parseI18n("Fine-Plugin_Shop_Msg-Delete_YES_NO"),function(){PluginHelper.getProgress("uninstall",function(value){if(value&&value.progress&&callback(value.progress),value&&value.status){callback.call(this,value.status);var info=value.info||"";"success"===value.status?PluginUtils.showNeededDialog(info+Store.parseI18n("Fine-Plugin_Shop_Delete_Success"),!0):"failed"===value.status&&("30"===value.errorCode?PluginUtils.showConfirmDialog(Store.parseI18n("Fine-Plugin_Shop_Delete_Dependence"),function(){PluginHelper.uninstallPlugin(pluginMarker,!0,callback)}):PluginUtils.showNeededDialog(info))}}),PluginUtils.uninstallPlugin({pluginMarker:pluginMarker,forceDelete:isForce,username:Dec.personal.username},function(res){})})},PluginHelper.updatePluginOnline=PluginHelper.updatePluginOnline||function(pluginInfo,callback){if(PluginHelper.isWar)PluginUtils.showNeededDialog(Store.parseI18n("Fine-Plugin_Shop_Error_No_Support_In_War_Or_Cluster"));else{PluginHelper.getProgress("update",function(value){if(value&&value.progress&&callback(value.progress),value&&value.status){callback.call(this,value.status);var info=value.info||"";"success"===value.status?PluginUtils.showNeededDialog(info+Store.parseI18n("Fine-Plugin_Shop_Update_Success"),!0):"failed"===value.status&&PluginUtils.showNeededDialog(info)}}),PluginUtils.updatePluginOnline({username:Dec.personal.username},pluginInfo,function(res){})}},PluginHelper.updatePluginFromDisk=PluginHelper.updatePluginFromDisk||function(path,callback){var self=this;if(PluginHelper.isWar)PluginUtils.showNeededDialog(Store.parseI18n("Fine-Plugin_Shop_Error_No_Support_In_War_Or_Cluster"));else{PluginHelper.getProgress("update_from_disk",function(value){if(value&&value.progress&&callback(value.progress),value&&value.status){callback.call(this,value.status);var info=value.info||"";"success"===value.status?PluginUtils.showNeededDialog(info+Store.parseI18n("Fine-Plugin_Shop_Update_Success"),!0):"failed"===value.status&&("35"===value.errorCode?PluginUtils.showConfirmDialog(Store.parseI18n("Fine-Plugin_Shop_No_Plugin_Update"),function(){Store.Progress.showProgress();var licenses=self.updateFromDiskEditor.getValue(),attachId=licenses[licenses.length-1].attach_id;PluginHelper.installPluginFromDisk({id:attachId,username:Dec.personal.username},callback)}):PluginUtils.showNeededDialog(info))}}),path&&path.id?PluginUtils.updatePluginFromDisk(path,function(res){}):$("#update-from-disk input").click()}},PluginHelper.setPluginActive=PluginHelper.setPluginActive||function(pluginInfo,callback){if(PluginHelper.isWar)PluginUtils.showNeededDialog(Store.parseI18n("Fine-Plugin_Shop_Error_No_Support_In_War_Or_Cluster"));else{PluginHelper.getProgress("modify",function(value){if(value&&value.progress&&callback(value.progress),value&&value.status){if("failed"===value.status)return void PluginUtils.showNeededDialog(value.info);callback.call(this,value.status),"forbid"===value.pluginStatus?PluginUtils.showNeededDialog(Store.parseI18n("Fine-Plugin_Shop_Has_Been_Disabled"),!0):"active"===value.pluginStatus&&PluginUtils.showNeededDialog(Store.parseI18n("Fine-Plugin_Shop_Has_Been_Actived"),!0)}}),PluginUtils.setPluginActive({pluginInfo:pluginInfo,username:Dec.personal.username},function(res){})}},PluginHelper.showFileChooser=PluginHelper.showFileChooser||function(){},PluginHelper.showFileChooserWithFilter=PluginHelper.showFileChooserWithFilter||function(description,filter){return"local_temp.zip"},PluginHelper.showFileChooserWithFilters=PluginHelper.showFileChooserWithFilters||function(description,filter){},PluginHelper.getInstalledPlugins=PluginHelper.getInstalledPlugins||function(callback){PluginUtils.reqGetInstalledPlugins("getInstalledPlugins",function(res){res.data&&callback(res.data)})},PluginHelper.getPluginFromStore=PluginHelper.getPluginFromStore||function(pg,cid,type,callback){PluginUtils.reqGetPluginFromStore({categories:pg,cid:cid,type:type},function(res){callback.call(this,res)})},PluginHelper.getPluginFromStoreNew=PluginHelper.getPluginFromStoreNew||function(classifyInfo,callback){var data=JSON.parse(classifyInfo);data.type=data.fee,data.cid=data.seller,PluginUtils.reqGetPluginFromStore(data,function(res){callback(res.data)})},PluginHelper.closeWindow=PluginHelper.closeWindow||function(){},PluginHelper.showRestartMessage=PluginHelper.showRestartMessage||function(message){},PluginHelper.searchPlugin=PluginHelper.searchPlugin||function(keyword,callback){PluginUtils.searchPlugin({keyword:keyword},function(res){callback(res.data)})},PluginHelper.readUpdateOnline=PluginHelper.readUpdateOnline||function(callback){PluginUtils.reqGetInstallPluginUpdateList(function(res){callback(res.data)})},PluginHelper.openShopUrlAtWebBrowser=PluginHelper.openShopUrlAtWebBrowser||function(url){window.open(url)},PluginHelper.getPluginCategories=PluginHelper.getPluginCategories||function(callback){PluginUtils.reqGetPluginCategories(function(res){res.data&&callback(res.data)})},PluginHelper.isCustomTitleBar=PluginHelper.isCustomTitleBar||function(){},PluginHelper.getRunConfig=PluginHelper.getRunConfig||function(){return""},PluginHelper.clearRunConfig=PluginHelper.clearRunConfig||function(){},PluginHelper.getLoginInfo=PluginHelper.getLoginInfo||function(callback){PluginUtils.reqGetLoginInfo(function(res){var $loginInfo=$(".loginInfo"),username=res.data;""!==username&&username?$loginInfo.text(username):$loginInfo.text(Store.parseI18n("Fine-Plugin_Shop_Store_Not_Login")),callback.call(this,username)})},PluginHelper.registerLoginInfo=PluginHelper.registerLoginInfo||function(callback){PluginUtils.reqGetLoginInfo(function(res){var $loginInfo=$(".loginInfo"),username=res.data;""!==username&&username?$loginInfo.text(username):$loginInfo.text(Store.parseI18n("Fine-Plugin_Shop_Store_Not_Login")),callback(username)})},PluginHelper.loginContent=PluginHelper.loginContent||function(){},PluginHelper.getPriviteMessage=PluginHelper.getPriviteMessage||function(){window.open("http://bbs.fanruan.com/home.php?mod=space&do=pm")},PluginHelper.registerHref=PluginHelper.registerHref||function(){window.open("http://id.fanruan.com/register/register.php?clueSource=activityfr")},PluginHelper.forgetHref=PluginHelper.forgetHref||function(){window.open("http://id.fanruan.com/forget/forget.php?clue=activityf")},PluginHelper.getPluginPrefix=PluginHelper.getPluginPrefix||function(callback){PluginUtils.reqGetPluginPrefix(function(res){callback(res.data)})},PluginHelper.defaultLogin=PluginHelper.defaultLogin||function(userInfo,password,callback){PluginUtils.defaultLogin({username:BI.encode(userInfo),password:BI.encode(password)},function(res){if($.isFunction(callback)){var decodeResult=res.data,loginTag=decodeResult.loginTag,uuid=decodeResult.uuid,username=decodeResult.username;loginTag=parseInt(loginTag,10),callback(loginTag),0===loginTag&&($(".loginInfo").text(username),Store.Login.LoginUser=username,PluginHelper.ucsynLogin(uuid,username,"",function(result){$(".sync-log").remove(),$("body").append('<div class="sync-log">'+result+"</div>")}))}})},PluginHelper.ucsynLogin=PluginHelper.ucsynLogin||function(uid,username,password,callback){PluginUtils.ucsynLogin({uid:encodeURI(uid),username:encodeURI(username),password:encodeURI(password)},function(res){callback(res.data)})},PluginHelper.showQQ=PluginHelper.showQQ||function(){},PluginHelper.clearUserInfo=PluginHelper.clearUserInfo||function(){PluginUtils.clearUserInfo(function(res){"success"===res.data&&(Store.Login.LoginUser="")})},PluginHelper.initExtraDiff=PluginHelper.initExtraDiff||function(){this.createLoginStatusPane(),this.installFromDiskEditor=this.createMuiltFile($("#install-from-disk"),function(data){PluginUtils.installPluginFromDisk(data,function(res){})}),this.updateFromDiskEditor=this.createMuiltFile($("#update-from-disk"),function(data){PluginUtils.updatePluginFromDisk(data,function(res){})})},PluginHelper.createLoginStatusPane=function(){var $panel_head=$("#app-shop-header"),$div=$('<div class="login"></div>'),$button=$('<Button class="loginInfo" type="button"></Button>');$div.append($button),$panel_head.append($div);var $panel_body=$("#panel-body"),$login_btn=$('<div class="loginBtn"></div>'),$bbsMsg=$('<Button class="bbs-msg" type="button"></Button>'),$loginIn=$('<Button class="loginIn" type="button"></Button>');$login_btn.append($bbsMsg),$login_btn.append($loginIn),$panel_body.append($login_btn)},PluginHelper.createFileChooser=function(fileEditorId,callback){this.createMuiltFile($("#"+fileEditorId),function(data){PluginUtils.installPluginFromDisk(data,function(res){})})},PluginHelper.isDesigner=PluginHelper.isDesigner||function(){return!1},PluginHelper.getPackInfo=PluginHelper.getPackInfo||function(callback){PluginUtils.reqGetProjectInfo(function(res){res.data.war&&(PluginHelper.isWar=!0),callback.call(this)})}}(),function($){null==window.Store&&(window.Store={}),Store.TitleBar={init:function(){if(PluginHelper.isDesigner())try{var $div=$("<div class = title-bar></div>");$div.append($('<div class="dialog-title"></div>')),$div.append($('<div class="dialog-close"></div>')),$("body").prepend($div),PluginHelper.isCustomTitleBar()?($(".dialog-title").text(Store.parseI18n("Fine-Plugin_Shop_Manager")),this.closeDialog()):($(".title-bar").remove(),$(".mainView,.sideView").addClass("old-tab-padding"),$(".mainView .panel-heading, .sideView .panel-heading").addClass("old-panel-heading"))}catch(e){$(".title-bar").remove(),$(".mainView,.sideView").addClass("old-tab-padding"),$(".panel-heading").addClass("old-panel-heading")}},closeDialog:function(){$(".dialog-close").bind("click",function(){PluginHelper.closeWindow()})}},Store.Plugin={defaultCallback:function(value){-1!=value.indexOf("%")?Store.Progress.setProgress(value):(-1!=value.indexOf("success")&&(Store.Progress.setProgress("100%"),window.setTimeout(function(){Store.Progress.removeProress()},500)),-1!=value.indexOf("failed")&&(Store.Progress.setProgress("100%"),window.setTimeout(function(){Store.Progress.removeProress()},500)),Store.Installed.showInstalledPlugin(),Store.Installed.checkUpdate())}},Store.Nav={type:"online",classifyInfo:{},component:"",selectPlugin:{},clock:"",showOnlinePluginCount:PluginHelper.isDesigner()?4:5,init:function(component){this.classifyInfo=new Store.ClassifyInfo,this.component=component,this.getCategories(),this.setNavBarListener(),this.setTagBarListener(),this.setInstallFromDiskBtnListener(),this.setSearchOnlineBtnListener(),this.runWithConfig(),this.setSelectPluginListener(),this.setInstallOnlineBtnListener()},runWithConfig:function(){try{var config=Store.Tool.jsonDecode(PluginHelper.getRunConfig());switch(config.action){case Store.RUNACTION.SEARCH:config.keyword&&""!=config.keyword?(this.fetchSearch(config.keyword),PluginHelper.clearRunConfig()):this.get_plugins_online();break;case Store.RUNACTION.SHOW_RESULT:config.pluginInfo&&""!=config.pluginInfo?(this.showPluginResult(config.keyword,config.pluginInfo),PluginHelper.clearRunConfig()):this.get_plugins_online();break;default:this.get_plugins_online()}}catch(e){this.get_plugins_online()}},getCategories:function(){try{PluginHelper.getPluginCategories(function(result){var categories=PluginHelper.isDesigner()?Store.Tool.jsonDecode(result):result;Store.Render.showCategories({renderEl:$(".nav-group"),removeEl:$(".nav-category"),categories:categories}),Store.Nav.setNavBarListener()})}catch(e){}},get_plugins_online:function(){this.showTransition();function callback(result){if(Store.Nav.hideTransition(),Store.Nav.isConnected(result)){var pluginInfo=PluginHelper.isDesigner()?Store.Tool.jsonDecode(result):result;Store.Nav.component.html(""),pluginInfo&&0!=pluginInfo.length&&$.isArray(pluginInfo)&&Store.Nav.component&&(Store.Render.window_show(pluginInfo,Store.Nav.component,Store.Nav.showOnlinePluginCount,Store.Nav.type),Store.Nav.setClearSelectedListener()),Store.Nav.clearSelected()}}!0===PluginHelper.isDesigner()&&void 0===PluginHelper.getPluginFromStoreNew?PluginHelper.getPluginFromStore(this.classifyInfo.categories,this.classifyInfo.seller,this.classifyInfo.fee,callback):PluginHelper.getPluginFromStoreNew(JSON.stringify(this.classifyInfo),callback)},isConnected:function(result){return!(!result||"404"==result||-1==result)||($(".product-info-panel-body").html('<div class="disconnected"></div><div class="oops">'+Store.parseI18n("Fine-Plugin_Shop_Store_Disconnected")+"</div>"),!1)},setNavBarListener:function(){var that=this;$(".nav-seller").unbind("click"),$(".nav-fee").unbind("click"),$(".nav-scope").unbind("click"),$(".nav-category").unbind("click"),$(".nav-seller").click(function(e){return e.target&&"A"==e.target.nodeName.toUpperCase()&&(that.removeSearchTag(),that.classifyInfo.clearSeller(),$(".tags").append('<div class="status-item pull-left" id="'+e.target.id+'-tag">'+e.target.innerText+'<div class="tag-close"></div></div>'),that.classifyInfo.seller=e.target.id,$(e.target).addClass("selected-item"),that.get_plugins_online()),!1}),$(".nav-fee").click(function(e){return e.target&&"A"==e.target.nodeName.toUpperCase()&&(that.removeSearchTag(),that.classifyInfo.clearFee(),$(".tags").append('<div class="status-item pull-left" id="'+e.target.id+'-tag">'+e.target.innerText+'<div class="tag-close"></div></div>'),that.classifyInfo.fee=e.target.id,$(e.target).addClass("selected-item"),that.get_plugins_online()),!1}),$(".nav-scope").click(function(e){return e.target&&"A"==e.target.nodeName.toUpperCase()&&(that.removeSearchTag(),that.classifyInfo.clearScope(),$(".tags").append('<div class="status-item pull-left" id="'+e.target.id+'-tag">'+e.target.innerText+'<div class="tag-close"></div></div>'),that.classifyInfo.scope=e.target.id,$(e.target).addClass("selected-item"),that.get_plugins_online()),!1}),$(".nav-category").click(function(e){return e.target&&"A"==e.target.nodeName.toUpperCase()&&(that.removeSearchTag(),that.classifyInfo.clearCategory(),$(".tags").append('<div class="status-item pull-left" id="'+e.target.id+'-tag">'+e.target.innerText+'<div class="tag-close"></div></div>'),that.classifyInfo.categories=e.target.id,$(e.target).addClass("selected-item"),that.get_plugins_online()),!1})},setTagBarListener:function(){var that=this;$(".tags").click(function(e){if(e.target&&"tag-close"==e.target.className){switch($(e.target.parentNode).remove(),e.target.parentNode.id.split("-")[0]){case"seller":$("#"+that.classifyInfo.seller).removeClass("selected-item"),that.classifyInfo.seller="";break;case"fee":$("#"+that.classifyInfo.fee).removeClass("selected-item"),that.classifyInfo.fee="";break;case"scope":$("#"+that.classifyInfo.scope).removeClass("selected-item"),that.classifyInfo.scope="";break;case"category":$("#"+that.classifyInfo.categories).removeClass("selected-item"),that.classifyInfo.categories=""}that.classifyInfo.isEmpty()&&$('<div class="recommend-item pull-left" id="recommend-tag"></div>').text(Store.parseI18n("Fine-Plugin_Shop_Store_Recommend")).appendTo($(".tags")),that.get_plugins_online()}return!1})},setSelectPluginListener:function(){var that=this;this.component.click(function(e){var id,installBtn=$("#install-plugin-btn");if(-1!=e.target.offsetParent.className.indexOf("thumbnail"))id=e.target.offsetParent.id;else{if(-1==e.target.className.indexOf("thumbnail"))return that.clearSelected(),installBtn.attr("disabled","disabled"),!1;id=e.target.id}if(that.selectPlugin.id&&id==that.selectPlugin.id)return that.clearSelected(),!1;that.clearSelected();var currentPlugin=$("#"+id);return currentPlugin.append('<div class="fr-thumbnail-marked"></div>'),currentPlugin.addClass("fr-thumbnail-selected-border"),that.selectPlugin.pluginId=currentPlugin.data("pluginId"),that.selectPlugin.version=currentPlugin.data("version"),that.selectPlugin.id=id,installBtn.removeAttr("disabled"),!1})},clearSelected:function(){var installBtn=$("#install-plugin-btn");this.selectPlugin&&this.selectPlugin.id&&($("#"+this.selectPlugin.id).removeClass("fr-thumbnail-selected-border"),$("#"+this.selectPlugin.id+" .fr-thumbnail-marked").remove(),this.selectPlugin={},installBtn.attr("disabled","disabled"))},setInstallFromDiskBtnListener:function(){return $("#install-plugin-from-disk").bind("click",function(){var path=PluginHelper.showFileChooserWithFilter(Store.parseI18n("Fine-Plugin_Shop_Install_Package")+"(*.zip)","*.zip");if(!path)return!1;PluginHelper.installPluginFromDisk(path,function(value){Store.Plugin.defaultCallback(value)})}),!1},setInstallOnlineBtnListener:function(){$("#install-plugin-btn").bind("click",function(){try{Store.navSelectPlugin=Store.Nav.selectPlugin,PluginHelper.getLoginInfo(function(res){if(""===(Store.Login.LoginUser=res)){var clock=Store.Nav.clock;window.clearInterval(Number(clock));var inter=window.setInterval(function(){Store.Nav.info(Store.navSelectPlugin.pluginId,Store.navSelectPlugin.version)},1e3);Store.Nav.clock=inter,Store.Nav.showLoginDlg()}else Store.Progress.showProgress(),PluginHelper.installPluginOnline(Store.navSelectPlugin.pluginId+"_"+Store.navSelectPlugin.version,function(value){Store.Plugin.defaultCallback(value),Store.navSelectPlugin=null})})}catch(e){alert(e.message)}})},info:function(pluginId,version){if(""!=Store.Login.LoginUser){var clock=Store.Nav.clock;window.clearInterval(Number(clock)),Store.Progress.showProgress(),PluginHelper.installPluginOnline(pluginId+"_"+version,function(value){Store.Plugin.defaultCallback(value),Store.navSelectPlugin=null})}},setSearchOnlineBtnListener:function(){var search=$(".fr-search-query-online"),that=this;search.bind("keydown",function(e){if(e&&13==e.keyCode)return!1}),search.bind("click",function(){return-1!=search.text().trim().indexOf(Store.parseI18n("Fine-Plugin_Shop_Store_Commodity_Description"))&&(search.text(""),search.focus()),!1}),search.bind("blur",function(){""===search.text().trim()&&search.text(Store.parseI18n("Fine-Plugin_Shop_Store_Commodity_Description"))}),search.bind("keyup",function(e){e&&13==e.keyCode&&that.fetchSearch(search.text().trim())})},fetchSearch:function(keyword){keyword&&""!=keyword&&(this.classifyInfo.clear(),this.removeSearchTag(),$(".tags").append('<div class="status-item pull-left search-tag">'+Store.parseI18n("Fine-Plugin_Shop_Store_Key_Word")+":"+keyword+'<div class="tag-close"></div></div>'),this.showTransition(),PluginHelper.searchPlugin(encodeURI(keyword),function(value){if(Store.Nav.hideTransition(),!Store.Nav.isConnected(value))return!1;var pluginInfo=PluginHelper.isDesigner()?Store.Tool.jsonDecode(value):value;Store.Nav.component.html(""),pluginInfo&&0!=pluginInfo.length&&Store.Render.window_show(pluginInfo,Store.Nav.component,Store.Nav.showOnlinePluginCount,Store.Nav.type)}))},showPluginResult:function(keyword,data){this.classifyInfo.clear(),this.removeSearchTag(),Store.Nav.hideTransition(),keyword&&""!=keyword&&$(".tags").append('<div class="status-item pull-left search-tag">'+Store.parseI18n("Fine-Plugin_Shop_Store_Key_Word")+":"+keyword+'<div class="tag-close"></div></div>');var pluginInfo=Store.Tool.jsonDecode(data);Store.Nav.component.html(""),pluginInfo&&0!=pluginInfo.length&&(Store.Render.window_show(pluginInfo,Store.Nav.component,Store.Nav.showOnlinePluginCount,Store.Nav.type),setTimeout(function(){$("#"+pluginInfo[0].id).click()},200))},removeSearchTag:function(){var $searchTag=$(".search-tag");$searchTag&&$searchTag.remove()},setPluginMoreInfo:function(){$(".moreInfo").off("click").on("click",function(e){var url=$(e.target).data("url");return PluginHelper.openShopUrlAtWebBrowser(Store.Render.SHOP_PRODUCT+url),!1})},setClearSelectedListener:function(){var that=this;$(".mainView .panel-body").bind("click",function(){return that.clearSelected(),!1})},showTransition:function(){$(".transition").show(),$(".product-row").addClass("blur-loading")},hideTransition:function(){$(".transition").hide(),$(".product-row").removeClass("blur-loading")},showLoginDlg:function(){$(".login-dlg").css("display","block")}},Store.Installed={type:"local",component:"",installedPlugin:[],selectPlugin:{},availableUpdate:[],clock:"",showInstalledPluginCount:PluginHelper.isDesigner()?2:3,init:function(component){this.component=component,this.showInstalledPlugin(),this.setSelectPluginListener(),this.setDisableBtnListener(),this.setUninstallBtnListener(),this.setUpdateFromDisk(),this.setUpdateAllBtnListener(),this.setSearchLocalBtnListener(),this.setBtnStates()},parse_plugins_local:function(data){var plugins=PluginHelper.isDesigner()?Store.Tool.jsonDecode(data):data;$.each(plugins,function(i,plugin){plugin.getID=function(){return plugin.id},plugin.getName=function(){return plugin.name},plugin.getVersion=function(){return plugin.version},plugin.getEnvVersion=function(){return plugin.envVersion},plugin.getChangeNotes=function(){return plugin.changeNotes},plugin.getPrice=function(){return plugin.price},plugin.getDeadline=function(){return plugin.deadline},plugin.isRegisterFailed=function(){return plugin.registerFailed},plugin.getVendor=function(){return plugin.vendor},plugin.isHidden=function(){return plugin.hidden},plugin.getRequiredJarTime=function(){return plugin.requiredJarTime},plugin.getDescription=function(){return plugin.description},plugin.isActive=function(){return plugin.active},plugin.isLicDamaged=function(){return plugin.licDamaged},plugin.isAvailable=function(){return plugin.available},plugin.getLeftDays=function(){return plugin.leftDays},plugin.isOnTrial=function(){return plugin.onTrial},plugin.isFree=function(){return plugin.free},plugin.getSelfState=function(){return plugin.selfState},plugin.getSwitchedReason=function(){return plugin.switchedReason}}),plugins&&$.each(plugins,function(i,plugin){var pluginInfo={};pluginInfo.id=plugin.getID(),pluginInfo.name=plugin.getName(),pluginInfo.version=plugin.getVersion(),pluginInfo.vendor=plugin.getVendor(),pluginInfo.active=plugin.isActive(),pluginInfo.hidden=plugin.isHidden(),pluginInfo.jartime=plugin.getRequiredJarTime(),pluginInfo.description=plugin.getDescription(),pluginInfo.is_jar_damaged=plugin.isLicDamaged(),pluginInfo.is_available=plugin.isAvailable(),pluginInfo.left_time=plugin.getLeftDays(),pluginInfo.is_trial=plugin.isOnTrial(),pluginInfo.is_free=plugin.isFree(),pluginInfo.self_state=plugin.getSelfState(),pluginInfo.switched_reason=plugin.getSwitchedReason(),Store.Installed.installedPlugin.push(pluginInfo)})},showInstalledPlugin:function(){PluginHelper.getInstalledPlugins(function(res){if(Store.Installed.installedPlugin=[],Store.Installed.parse_plugins_local(res),Store.Installed.checkUpdate(),Store.Installed.component){Store.Installed.component.html("");var pluginsToShow=Store.Installed.filterHidePlugins();$(".installed-count").html(Store.parseI18n("Fine-Plugin_Shop_Store_Installed")+pluginsToShow.length+Store.parseI18n("Fine-Plugin_Shop_Store_Plugins_Count")),Store.Render.window_show(pluginsToShow,Store.Installed.component,Store.Installed.showInstalledPluginCount,Store.Installed.type),Store.Installed.setClearSelectedListener()}})},filterHidePlugins:function(){for(var plugins=[],i=0;i<this.installedPlugin.length;i++)this.installedPlugin[i].hidden||plugins.push(this.installedPlugin[i]);return plugins},setBtnStates:function(){var $disableBtn=$("#disable-plugin-btn"),$deleteBtn=$("#delete-plugin-btn"),$updateAllBtn=$("#update-all-plugin-btn");if(this.selectPlugin&&this.selectPlugin.id){$deleteBtn.removeAttr("disabled"),this.selectPlugin.active?$disableBtn.text(Store.parseI18n("Fine-Plugin_Shop_Store_Disabled")):$disableBtn.text(Store.parseI18n("Fine-Plugin_Shop_Store_Enable")),$disableBtn.removeAttr("disabled"),$updateAllBtn.text(Store.parseI18n("Fine-Plugin_Shop_Store_Update"));for(var i=0;i<this.availableUpdate.length;i++)if(this.availableUpdate[i].id==this.selectPlugin.id)return void $updateAllBtn.removeAttr("disabled");$updateAllBtn.attr("disabled","disabled"),1==this.selectPlugin.self_state&&$disableBtn.hide()}else 0==this.availableUpdate.length?$updateAllBtn.attr("disabled","disabled"):$updateAllBtn.removeAttr("disabled"),$updateAllBtn.text(Store.parseI18n("Fine-Plugin_Shop_Store_Update-ALL")),$disableBtn.attr("disabled","disabled"),$deleteBtn.attr("disabled","disabled"),$disableBtn.show()},setSelectPluginListener:function(){var that=this;this.component.click(function(e){var id;if(-1!=e.target.offsetParent.className.indexOf("thumbnail"))id=e.target.offsetParent.id;else{if(-1==e.target.className.indexOf("thumbnail"))return that.clearSelected(),that.setBtnStates(),!1;id=e.target.id}if(id.replace(/-/g,".")==that.selectPlugin.id)return that.clearSelected(),!1;that.clearSelected();var currentPlugin=$("#"+id);currentPlugin.append('<div class="fr-thumbnail-marked"></div>'),currentPlugin.addClass("fr-thumbnail-selected-border");for(var i=0;i<that.installedPlugin.length;i++)if(id.replace(/-/g,".")==that.installedPlugin[i].id){that.selectPlugin=that.installedPlugin[i];break}return that.setBtnStates(),!1})},clearSelected:function(){this.selectPlugin&&this.selectPlugin.id&&($("#"+this.selectPlugin.id.replace(/\./g,"-")).removeClass("fr-thumbnail-selected-border"),$("#"+this.selectPlugin.id.replace(/\./g,"-")+" .fr-thumbnail-marked").remove(),this.selectPlugin={},this.setBtnStates())},setClearSelectedListener:function(){var $sideView=$(".sideView .panel-body"),that=this;$sideView.bind("click",function(){return that.clearSelected(),!1})},setDisableBtnListener:function(){var that=this;$("#disable-plugin-btn").bind("click",function(){return PluginHelper.setPluginActive(that.selectPlugin.id+"_"+that.selectPlugin.version,function(){for(var i=0;i<Store.Installed.installedPlugin.length;i++)if(Store.Installed.selectPlugin.id==Store.Installed.installedPlugin[i].id){Store.Installed.installedPlugin[i].active=!Store.Installed.installedPlugin[i].active,Store.Installed.selectPlugin.active=Store.Installed.installedPlugin[i].active;break}Store.Installed.showInstalledPlugin(),Store.Installed.checkUpdate()}),!1})},setUninstallBtnListener:function(){var that=this;$("#delete-plugin-btn").bind("click",function(){var pluginInfo=that.selectPlugin.id+"_"+that.selectPlugin.version;return PluginHelper.uninstallPlugin(pluginInfo,!1,function(){Store.Installed.showInstalledPlugin(),Store.Installed.checkUpdate()}),!1})},setUpdateFromDisk:function(){return $("#update-plugin-from-disk").bind("click",function(){var path=PluginHelper.showFileChooserWithFilter(Store.parseI18n("Fine-Plugin_Shop_Install_Package")+"(*.zip)","*.zip");if(!path)return!1;PluginHelper.updatePluginFromDisk(path,function(value){Store.Plugin.defaultCallback(value)})}),!1},setUpdateAllBtnListener:function(){$("#update-all-plugin-btn").bind("click",function(e){e.stopPropagation(),PluginHelper.getLoginInfo(function(res){Store.Login.LoginUser=res;var pluginInfo=[],waitToUpdate=[];Store.Installed.selectPlugin&&Store.Installed.selectPlugin.id?waitToUpdate.push(Store.Installed.selectPlugin):waitToUpdate=Store.Installed.availableUpdate;for(var i=0;i<waitToUpdate.length;i++)pluginInfo.push(waitToUpdate[i].id+"_"+waitToUpdate[i].version);if(""==res){var clock=Store.Installed.clock;window.clearInterval(Number(clock));var inter=window.setInterval(function(){Store.Installed.info(pluginInfo)},1e3);Store.Installed.clock=inter,Store.Nav.showLoginDlg()}else Store.Progress.showProgress(),PluginHelper.updatePluginOnline(pluginInfo,function(value){Store.Plugin.defaultCallback(value)})})})},info:function(pluginIDs){if(""!=Store.Login.LoginUser){var clock=Store.Installed.clock;window.clearInterval(Number(clock)),Store.Progress.showProgress(),PluginHelper.updatePluginOnline(pluginIDs,function(value){Store.Plugin.defaultCallback(value)})}},setSearchLocalBtnListener:function(){var search=$(".fr-search-query-local"),that=this;search.bind("keydown",function(e){if(e&&13==e.keyCode)return!1}),search.bind("click",function(){return-1!=search.text().trim().indexOf(Store.parseI18n("Fine-Plugin_Shop_Store_Commodity_Description"))&&(search.text(""),search.focus()),!1}),search.bind("blur",function(){""==search.text().trim()&&search.text(Store.parseI18n("Fine-Plugin_Shop_Store_Commodity_Description"))}),search.bind("keyup",function(e){that.selectPlugin={},that.setBtnStates();var keyword=search.text().trim();if(e&&13==e.keyCode){for(var searchResult=[],i=0;i<that.installedPlugin.length;i++)(-1!=that.installedPlugin[i].name.toUpperCase().indexOf(keyword.toUpperCase())||keyword==that.installedPlugin[i].version||that.installedPlugin[i].description&&-1!=that.installedPlugin[i].description.toUpperCase().indexOf(keyword.toUpperCase()))&&!that.installedPlugin[i].hidden&&searchResult.push(that.installedPlugin[i]);Store.Render.window_show(searchResult,that.component,Store.Installed.showInstalledPluginCount,that.type)}(e&&8==e.keyCode||46==e.keyCode)&&""==keyword&&Store.Render.window_show(that.installedPlugin.filter(function(item){return!item.hidden}),that.component,Store.Installed.showInstalledPluginCount,that.type)})},findInstalledPluginByID:function(pluginID){for(var plugins=Store.Installed.installedPlugin,i=0;i<plugins.length;i++)if(plugins[i].id===pluginID)return plugins[i].id+"_"+plugins[i].version},checkUpdate:function(){Store.Installed.availableUpdate=[],PluginHelper.readUpdateOnline(function(value){var plugin=PluginHelper.isDesigner()?Store.Tool.jsonDecode(value):value;if(plugin){for(var i=0;i<Store.Installed.installedPlugin.length;i++)for(var j=0;j<plugin.length;j++)Store.Installed.installedPlugin[i].id===plugin[j].pluginId&&(Store.Installed.installedPlugin[i].hasUpdate=!0,Store.Installed.availableUpdate.push(Store.Installed.installedPlugin[i]));var plugins=Store.Installed.filterHidePlugins();if(Store.Render.window_show(plugins,Store.Installed.component,Store.Installed.showInstalledPluginCount,Store.Installed.type),Store.Installed.selectPlugin.id){var id=isNaN(Store.Installed.selectPlugin.id)?Store.Installed.selectPlugin.id.replace(/\./g,"-"):Store.Installed.selectPlugin.id,currentPlugin=$("#"+id);currentPlugin.append('<div class="fr-thumbnail-marked"></div>'),currentPlugin.addClass("fr-thumbnail-selected-border")}Store.Installed.setBtnStates()}})}},Store.Progress={$process:$('<div class="fr-progress pull-left"><div class="fr-progress-bar"></div></div>'),showProgress:function(){this.$process.appendTo($(".install-btn-group"))},setProgress:function(value){$(".fr-progress .fr-progress-bar").css("width",value)},removeProress:function(){this.$process.remove(),this.$process.children(".fr-progress-bar").css("width",0)}},Store.Render={SHOP_PRODUCT:"",getUrlPrefix:function(){PluginHelper.getPluginPrefix(function(result){Store.Render.SHOP_PRODUCT=result})},showCategories:function(options){var renderEl=$(options.renderEl),categories=options.categories,row=[];if(categories&&$.isArray(categories)&&categories!=[]){var currentRow;options.removeEl&&$(options.removeEl).remove();for(var i=0;i<categories.length;i++){if(0===i){row[row.length]=$('<div class="row last-row nav-category"></div>').appendTo(renderEl),$('<div class="items-head" id="items-head-class"></div>').text("类别").appendTo(row[i]);var itemsBody=$('<div class="items-body"></div>').appendTo(row[i]);currentRow=$('<div class="items extra-items category-items"></div>').appendTo(itemsBody)}else if(i%8==0){row[row.length]=$('<div class="row nav-category"></div>').appendTo(renderEl);var itemsBodyEx=$('<div class="items-body"></div>').appendTo(row[row.length-1]);currentRow=$('<div class="items category-items"></div>').appendTo(itemsBodyEx)}$('<a href="#" class="item" id="category-'+categories[i].id+'">'+categories[i].name+"</a>").appendTo(currentRow)}}},window_show:function(ces,content,numPreRow,type){this.getUrlPrefix(),window.frrows=[];var c,imgtag,tipDirection,licenseInfo="";content.html("");for(var i=0;i<ces.length;i++)i%numPreRow==0&&(frrows[frrows.length]=$('<div class="row"/>').appendTo(content)),tipDirection=i%numPreRow<numPreRow/2?"right":"left",c=$('<div class="thumbnail clearfix" id="'+(isNaN(ces[i].id)?ces[i].id.replace(/\./g,"-"):ces[i].id)+'">').appendTo($('<div class="col-sm-'+Math.floor(12/numPreRow)+'"/>').appendTo(frrows[frrows.length-1])),type&&"local"==type?this.showLocal(ces[i],c,tipDirection):type&&"online"==type&&this.showOnline(ces[i],c,tipDirection),imgtag=ces[i].pic&&"null"!=ces[i].pic&&-1===ces[i].pic.indexOf("default_product.png")?'<img width=100px height=100px src="'+ces[i].pic+'" class="img-responsive center-block"/>':'<img width=100px height=100px src="'+Store.resourceUrl+'/scripts/img/product-01.png" alt="Product" class="img-responsive center-block"/>',c.append('<div class="left"><div class="image">'+imgtag+"</div></div>"),licenseInfo=this.licenseInfo(ces[i]),c.append('<div class="right"><div class="name">'+ces[i].name+'</div><div class="version">V'+ces[i].version+licenseInfo+"</div></div>");var $toolTip=$('[data-toggle="delayTooltip"]');$toolTip.delayTooltip(),$toolTip.on("shown.bs.delayTooltip",function(){Store.Nav.setPluginMoreInfo()})},licenseInfo:function(product){var licenseInfo="";return product.is_jar_damaged?licenseInfo=Store.parseI18n("Fine-Plugin_Shop_Store_Jar_Damaged"):"number"!=typeof product.left_time||product.is_free||(product.is_available?licenseInfo=(product.is_trial?Store.parseI18n("Fine-Plugin_Shop_Store_Probation"):Store.parseI18n("Fine-Plugin_Shop_Store_Authorize"))+(9999<product.left_time?Store.parseI18n("Fine-Plugin_Shop_Store_Permanent"):product.left_time+Store.parseI18n("Fine-Plugin_Shop_Store_Day")):!1===product.is_available&&(licenseInfo=(product.is_trial?Store.parseI18n("Fine-Plugin_Shop_Store_Probation"):Store.parseI18n("Fine-Plugin_Shop_Store_Authorize"))+Store.parseI18n("Fine-Plugin_Shop_Store_Expired"))),licenseInfo},showOnline:function(product,component,tipDirection){this._toolTip(product,component),component.attr("data-placement",tipDirection),component.data("pluginId",product.pluginid),component.data("version",product.version)},_toolTip:function(product,component){var priceShow="",footerExtra="",moreInfoBtn="",switchedReason="",description="",vendor="";product.vendor&&(vendor=(vendor=-1==product.vendor.toLowerCase().indexOf("finereport")?product.vendor:Store.parseI18n("Fine-Plugin_Shop_Store_Finereport")).length<6?vendor:vendor.slice(0,5)+".."),1==product.self_state&&(switchedReason=100<(switchedReason=product.switched_reason.replace(/<.*?>/g,"").replace(/<\/.*?>/g,"")).length?switchedReason.slice(0,100)+"..":switchedReason+"&nbsp&nbsp&nbsp&nbsp"),product.description&&(description=100<(description=product.description.replace(/<.*?>/g,"").replace(/<\/.*?>/g,"")).length?description.slice(0,100)+"..":description+"&nbsp&nbsp&nbsp&nbsp"),product.uploadTime?(footerExtra='<div class="upload_time pull-right" >'+Store.parseI18n("Fine-Plugin_Shop_Store_Update")+":"+product.uploadTime.split("T")[0].replace(/-/g,"/")+'</div><div class="version pull-left" >'+Store.parseI18n("Fine-Plugin_Shop_Store_Version")+":"+product.version+"</div>",moreInfoBtn='<button data-url="'+product.id+'" class="moreInfo" id="moreInfo'+product.id+'"></button>',$.isNumeric(product.price)&&0<Number(product.price)?price="￥"+product.price:$.isNumeric(product.price)&&-1==Number(product.price)?price=Store.parseI18n("Fine-Plugin_Shop_Plugin_Purchase_Consult"):price=Store.parseI18n("Fine-Plugin_Shop_Store_Free"),priceShow='<div class="head-right">'+price+"</div>"):"number"==typeof product.left_time&&(priceShow='<div class="head-right">'+(""==this.licenseInfo(product)?Store.parseI18n("Fine-Plugin_Shop_Store_Free"):this.licenseInfo(product))+"</div>");var jarTime=product.jartime?product.jartime.split("T")[0].replace(/-/g,"/"):"",temp='<div class="tooltip"><div class="fr-tooltip" role="tooltip"><div class="head-left">'+product.name+"</div>"+priceShow+'<div class="content">'+(1==product.self_state?'<span style="color:red">'+switchedReason+"<br></span>":"")+description+moreInfoBtn+'<div class="footer"><div class="vendor pull-left" >'+Store.parseI18n("Fine-Plugin_Shop_Store_Developer")+":"+vendor+"</div>"+footerExtra+'<div class="jar_time pull-right" >'+Store.parseI18n("Fine-Plugin_Shop_Store_Jar")+":"+jarTime+"</div></div></div></div>";component.attr("data-toggle","delayTooltip"),component.attr("data-html",!0),component.attr("data-title","-00-"),component.attr("data-template",temp)},showLocal:function(product,component,tipDirection){1==product.self_state?component.append('<div class="fr-thumbnail-unreachable-tag"></div>'):0==product.active&&1==product.hasUpdate?component.append('<div class="fr-thumbnail-disable-new-tag"></div>'):(0==product.active&&component.append('<div class="fr-thumbnail-disable-tag"></div>'),1==product.hasUpdate&&component.append('<div class="fr-thumbnail-new-tag"></div>')),this._toolTip(product,component,tipDirection),component.attr("data-placement","bottom-"+tipDirection)}},Store.Tool={jsonDecode:function(text){try{""===text&&(text="{}");var jo=$.parseJSON(text);null==jo&&(jo={})}catch(e){try{jo=new Function("return "+text)()||{}}catch(e){}null==jo&&(jo=[])}return this.hasDateInJson(text)?function(o){if("string"==typeof o)return o;if(o&&null!=o.__time__)return new Date(o.__time__);for(var a in o){if(o[a]==o||"object"==typeof o[a]||$.isFunction(o[a]))break;o[a]=arguments.callee(o[a])}return o}(jo):jo},hasDateInJson:function(json){return!(!json||"string"!=typeof json)&&-1!=json.indexOf("__time__")}},Store.ClassifyInfo=function(){this.categories="",this.seller="",this.fee="",this.scope=""},Store.ClassifyInfo.prototype={isEmpty:function(){return""==this.categories&&""==this.seller&&""==this.fee&&""==this.scope},clear:function(){this.clearCategory(),this.clearSeller(),this.clearFee(),this.clearScope()},removeExist:function(id){var recommendTag=$("#recommend-tag");recommendTag&&recommendTag.remove(),id&&""!=id&&$("#"+id+"-tag").remove()},clearCategory:function(){$("#"+this.categories).removeClass("selected-item"),this.removeExist(this.categories),this.categories=""},clearSeller:function(){$("#"+this.seller).removeClass("selected-item"),this.removeExist(this.seller),this.seller=""},clearFee:function(){$("#"+this.fee).removeClass("selected-item"),this.removeExist(this.fee),this.fee=""},clearScope:function(){$("#"+this.scope).removeClass("selected-item"),this.removeExist(this.scope),this.scope=""}},Store.RUNACTION={SEARCH:"search",SHOW_RESULT:"showResult"}}(jQuery),window.onresize=function(){getWindowSize()},function($){function fun(e){var qqLoginResult=Store.Tool.jsonDecode((e.originalEvent||e).data);if(qqLoginResult){var uid=qqLoginResult.uid,username=qqLoginResult.username,password=qqLoginResult.password,$loginInfo=$(".loginInfo");0<uid&&($(".qq-dialog-close").trigger("click"),$loginInfo.text(username),Store.Login.LoginUser=username,PluginHelper.ucsynLogin(uid,username,password,function(result){$(".sync-log").remove(),$("body").append('<div class="sync-log">'+result+"</div>")}),Store.Login.hideDialog())}}window.addEventListener?window.addEventListener("message",fun,!1):window.attachEvent("onmessage",fun),void 0===window.Store&&(window.Store={}),Store.Login={LoginUser:"",init:function(){this.registerLoginInfo(),this.setLoginListener(),this.setRegisterHref(),this.setForgetHref(),this.defaultLogin(),this.closeDialog(),this.qqLogin(),this.closeQQDialog(),this.keyBind()},registerLoginInfo:function(){PluginHelper.registerLoginInfo(function(result){Store.Login.LoginUser=result})},getLoginInfo:function(callback){PluginHelper.getLoginInfo(function(result){Store.Login.LoginUser=result,callback.call(this,result)})},setLoginListener:function(){var self=this;$(".loginInfo").bind("click",function(){""===Store.Login.LoginUser?($(".username").val(""),$(".password").val(""),$(".error-msg").text(""),self.showDialog()):"none"===$(".loginBtn").css("display")?$(".loginBtn").css("display","block"):$(".loginBtn").css("display","none")}),$(".bbs-msg").text(Store.parseI18n("Fine-Plugin_Shop_Store_Private_Message")).bind("click",function(){$(".loginBtn").css("display","none"),PluginHelper.getPriviteMessage()}),$(".loginIn").text(Store.parseI18n("Fine-Plugin_Shop_Store_Switch_Account")).bind("click",function(){PluginHelper.clearUserInfo(),$(".loginInfo").text(Store.parseI18n("Fine-Plugin_Shop_Store_Not_Login")),$(".loginBtn").css("display","none"),self.showDialog()})},setRegisterHref:function(){$(".register").bind("click",function(){PluginHelper.registerHref()})},setForgetHref:function(){$(".forget").bind("click",function(){PluginHelper.forgetHref()})},defaultLogin:function(){var self=this;$(".login-btn").bind("click",function(){self.hideErrorMsg();var username=$(".user-info").val(),password=$(".password").val();0!==username.length&&0!==password.length?(self.showTransition(),PluginHelper.defaultLogin(username,password,function(res){Store.Login.hideTransition();var result=parseInt(res,10);0<=result&&(Store.Login.LoginUser=$(".user-info").val(),Store.Login.hideDialog()),-1===result&&Store.Login.showErrorMsg(Store.parseI18n("Fine-Plugin_Shop_Store_User_Not_Exist")),-2===result&&Store.Login.showErrorMsg(Store.parseI18n("Fine-Plugin_Shop_Store_User_Password_Error")),-3===result&&Store.Login.showErrorMsg(Store.parseI18n("Fine-Plugin_Shop_Store_Unexpected_Error")),-4===result&&Store.Login.showErrorMsg(Store.parseI18n("Fine-Plugin_Shop_Store_Net_Connect_Failed")),-5===result&&Store.Login.showErrorMsg(Store.parseI18n("Fine-Plugin_Shop_Store_Not_Null"))})):self.showErrorMsg(Store.parseI18n("Fine-Plugin_Shop_Store_Not_Null"))})},closeDialog:function(){var self=this;$(".login-close").bind("click",function(){self.hideDialog()})},qqLogin:function(){var self=this;$(".qqLoginIn").bind("click",function(){self.hideDialog(),document.getElementById("qqlogin").style.backgroundColor="#def",document.getElementById("qqlogin").src="https://graph.qq.com/oauth/show?which=ConfirmPage&display=pc&response_type=code&client_id=101332435&redirect_uri=http://login.fanruan.com/qq_login.php&a="+Math.random(),$(".qqLoginIframe").css("display","block")})},closeQQDialog:function(){$(".qq-dialog-close").bind("click",function(){$(".qqLoginIframe").css("display","none")})},showDialog:function(){$(".login-dlg").show(),$(".user-info").focus()},hideDialog:function(){$(".login-dlg").hide(),this.hideTransition(),this.hideErrorMsg(),$(".user-info").val(""),$(".password").val("")},showTransition:function(){$(".login-content .transition").show(),$(".default-login").addClass("blur-loading"),$(".login-btn").prop("disabled",!0)},hideTransition:function(){$(".login-btn").prop("disabled",!1),$(".login-content .transition").hide(),$(".default-login").removeClass("blur-loading")},showErrorMsg:function(text){var $errorMag=$(".error-msg");$errorMag.text(text),$errorMag.show()},hideErrorMsg:function(){var $errorMag=$(".error-msg");$errorMag.text(""),$errorMag.hide()},keyBind:function(){function handleKeyDown(event){13===event.which&&(event.preventDefault(),$(".login-btn").click())}$(".user-info").keydown(handleKeyDown),$(".password").keydown(handleKeyDown)}}}(jQuery),function($){null===window.Store&&(window.Store={}),Store.build=function(){this.dealI18nText(),this.initExtraDiff(),this.TitleBar.init(),this.Installed.init($(".installed-row")),this.Nav.init($("#product-row")),this.Login.init()},Store.dealI18nText=function(){$("#app-shop-header").text(Store.parseI18n("Fine-Plugin_Shop_Store_App")),$("#items-head-businesses").text(Store.parseI18n("Fine-Plugin_Shop_Store_Businesses")),$("#seller-finereport").text(Store.parseI18n("Fine-Plugin_Shop_Store_Official")),$("#seller-developer").text(Store.parseI18n("Fine-Plugin_Shop_Store_Not_Official")),$("#items-head-fee").text(Store.parseI18n("Fine-Plugin_Shop_Store_Cost")),$("#fee-charge").text(Store.parseI18n("Fine-Plugin_Shop_Store_Pay")),$("#fee-free").text(Store.parseI18n("Fine-Plugin_Shop_Store_Free")),$("#items-head-scope").text("场景"),$("#scope-universal").text("通用"),$("#scope-program").text("方案"),$("#items-head-class").text(Store.parseI18n("Fine-Plugin_Shop_Store_Category")),$("#recommend-tag").text(Store.parseI18n("Fine-Plugin_Shop_Store_Recommend")),$("#fr-online-search").text(Store.parseI18n("Fine-Plugin_Shop_Store_Commodity_Description")),$("#install-plugin-btn").text(Store.parseI18n("Fine-Plugin_Shop_Store_Install")),$("#install-plugin-from-disk").text(Store.parseI18n("Fine-Plugin_Shop_Store_Install_From_Local")),$("#local-plugins").text(Store.parseI18n("Fine-Plugin_Shop_Store_My_Plugins")),$("#fr-local-search").text(Store.parseI18n("Fine-Plugin_Shop_Store_Commodity_Description")),$("#installed-plugin-count").text(Store.parseI18n("Fine-Plugin_Shop_Store_No_Plugins")),$("#disable-plugin-btn").text(Store.parseI18n("Fine-Plugin_Shop_Store_Disabled")),$("#delete-plugin-btn").text(Store.parseI18n("Fine-Plugin_Shop_Store_Delete")),$("#update-all-plugin-btn").text(Store.parseI18n("Fine-Plugin_Shop_Store_Update-ALL")),$("#update-plugin-from-disk").text(Store.parseI18n("Fine-Plugin_Shop_Store_Update_From_Local")),$("#bbs-login").text(Store.parseI18n("Fine-Plugin_Shop_Store_BBS_Account_Login")),$("#Register").text(Store.parseI18n("Fine-Plugin_Shop_Store_Register")),$("#loginForget").text(Store.parseI18n("Fine-Plugin_Shop_Store_Forgot_Password")),$("#quick_login").text(Store.parseI18n("Fine-Plugin_Shop_Store_Quick_Login"))},Store.parseI18n=function(key){return Store.i18n&&Store.i18n[key]||key},Store.initExtraDiff=function(){PluginHelper.initExtraDiff()}}(jQuery);